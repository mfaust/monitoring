---
# schema-version: 1.1
# project_name: monitoring
version: '2.0'
services:
  database:
    image: bodsch/docker-mysql:latest
#    build: $HOME/src/private/docker-mysql
    container_name: database
    hostname: database
    env_file:
      - env/database.env
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - $HOME/.docker/data:/srv

  icinga2:
    image: bodsch/docker-icinga2:latest
#    build: $HOME/src/private/docker-icinga2
    container_name: icinga2
#    restart: always
    hostname: icinga2
    env_file:
      - env/database.env
      - env/icinga2.env
    depends_on:
      - database
    ports:
      - 5665:5665
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - $HOME/.docker/data:/srv
      - $HOME/.docker/data/monitoring:/var/cache/monitoring
      - $HOME/.docker/share/icinga2:/usr/local/monitoring
    links:
      - database:database

  icingaweb2:
#    image: bodsch/docker-icinga2:latest
    build: $HOME/src/private/docker-icingaweb2
    container_name: icinga2
#    restart: always
    hostname: icingaweb2
    env_file:
      - env/database.env
      - env/icinga2.env
      - env/icingaweb2.env
    depends_on:
      - database
    volumes:
      - /etc/localtime:/etc/localtime:ro
    links:
      - database:database
